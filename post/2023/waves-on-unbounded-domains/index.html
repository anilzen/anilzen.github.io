<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 5.9.7"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=/css/vendor-bundle.min.26c458e6907dc03073573976b7f4044e.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous media=print onload='this.media="all"'><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href=/css/wowchemy.b9992bc39f58597ce0fecaf651999475.css><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=google-site-verification content="CVDtdnmvDztdvP8XA_Fh0StEBOfqy3DM5L6GyojfVgk"><script async src="https://www.googletagmanager.com/gtag/js?id=G-1Q5LP68RP1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(e,t){gtag("event","click",{event_category:"outbound",event_label:e,transport_type:"beacon",event_callback:function(){t!=="_blank"&&(document.location=e)}}),console.debug("Outbound link clicked: "+e)}function onClickCallback(e){if(e.target.tagName!=="A"||e.target.host===window.location.host)return;trackOutboundLink(e.target,e.target.getAttribute("target"))}gtag("js",new Date),gtag("config","G-1Q5LP68RP1",{}),gtag("set",{cookie_flags:"SameSite=None;Secure"}),document.addEventListener("click",onClickCallback,!1)</script><meta name=author content="Anıl Zenginoğlu"><meta name=description content="I demonstrate the hyperboloidal compactification method for numerically solving wave equations on unbounded domains. Animations and code included!"><link rel=alternate hreflang=en-us href=https://anilzen.github.io/post/2023/waves-on-unbounded-domains/><link rel=canonical href=https://anilzen.github.io/post/2023/waves-on-unbounded-domains/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu6b147281c14d31ddea9d4b1ec87dcb1f_1135_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu6b147281c14d31ddea9d4b1ec87dcb1f_1135_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@AnilZenginoglu"><meta property="twitter:creator" content="@AnilZenginoglu"><meta property="twitter:image" content="https://anilzen.github.io/post/2023/waves-on-unbounded-domains/featured.webp"><meta property="og:type" content="article"><meta property="og:site_name" content="Anıl Zenginoğlu"><meta property="og:url" content="https://anilzen.github.io/post/2023/waves-on-unbounded-domains/"><meta property="og:title" content="How to solve wave equations on unbounded domains | Anıl Zenginoğlu"><meta property="og:description" content="I demonstrate the hyperboloidal compactification method for numerically solving wave equations on unbounded domains. Animations and code included!"><meta property="og:image" content="https://anilzen.github.io/post/2023/waves-on-unbounded-domains/featured.webp"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-12-14T00:01:00+00:00"><meta property="article:modified_time" content="2023-12-14T00:01:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://anilzen.github.io/post/2023/waves-on-unbounded-domains/"},"headline":"How to solve wave equations on unbounded domains","image":["https://anilzen.github.io/post/2023/waves-on-unbounded-domains/featured.webp"],"datePublished":"2023-12-14T00:01:00Z","dateModified":"2023-12-14T00:01:00Z","author":{"@type":"Person","name":"Anıl Zenginoğlu"},"publisher":{"@type":"Organization","name":"Anıl Zenginoğlu","logo":{"@type":"ImageObject","url":"https://anilzen.github.io/media/icon_hu6b147281c14d31ddea9d4b1ec87dcb1f_1135_192x192_fill_lanczos_center_3.png"}},"description":"I demonstrate the hyperboloidal compactification method for numerically solving wave equations on unbounded domains. Animations and code included!"}</script><title>How to solve wave equations on unbounded domains | Anıl Zenginoğlu</title>
<link rel=me href=https://mathstodon.xyz/@anilzen></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=8cf816e4b045f39cb80d5847a4d39701><script src=/js/wowchemy-init.min.9e4214442a7711d35691acd58f6f6361.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Anıl Zenginoğlu</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Anıl Zenginoğlu</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#publications><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/nsf-award-2309084><span>NSF Award</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span>
</a><a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span>
</a><a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>How to solve wave equations on unbounded domains</h1><p class=page-subtitle>Hyperboloidal compactification for the one-dimensional wave equation</p><div class=article-metadata><div><span class=author-highlighted>Anıl Zenginoğlu</span></div><span class=article-date>Dec 14, 2023
</span><span class=middot-divider></span>
<span class=article-reading-time>12 min read</span></div></div><div class=article-container><div class=article-style><p>This post is a practical guide to numerically solving wave equations on unbounded domains. Using standard numerical methods, I demonstrate a technique called <em>hyperboloidal compactification</em> to solve unbounded-domain wave equations directly (no truncation, no artificial boundaries) by mapping the unbounded domain to a finite domain.</p><p>Code for the demonstrations uses public libraries and is available as a Google Colab notebook so that you can run everything from a browser.</p><a target=_blank href="https://colab.research.google.com/drive/1w-cmd1UEWqQ6Bu1rHnfASp1ue7eCPLl4?usp=sharing"><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a><h2 id=why-waves>Why waves?</h2><p>Our most important senses, sight and sound, rely on waves. Electromagnetic and acoustic waves carry information from an external reality far from the immediate neighborhood of our body to our audiovisual system. Our current understanding of the fundamental building blocks of the Universe is based on waves. Quantum field theory models all elementary particles as wave-like excitations of quantum fields. Most remarkably, we have recently gained the ability to detect gravitational waves, or spacetime waves, from the most energetic phenomena in the Universe happening billions of light years away.</p><p>The ability to understand waves by solving the equations that describe them is essential also for practical applications, such as modeling of earthquakes (seismology), ocean waves and tsunamis (oceanography), sonar systems (acoustics), radar scattering off airplanes and antenna design (electromagnetism), among others.</p><p>But you probably didn&rsquo;t need that motivation if you&rsquo;re reading this.</p><h2 id=the-mathematical-model>The mathematical model</h2><p>The simplest equation that describes a wave is aptly named the wave equation. We&rsquo;ll consider the case with one space dimension
$$ \left(-\partial_t^2 + \partial_x^2\right) u(x,t) = 0. \tag{1} \label{1}$$
The acceleration (or curvature in time), $\partial_t^2$, is bced by the curvature in space, $\partial_x^2$. This delicate balance leads to solutions that propagate while maintaining their form. In one dimension, there are only two directions a wave can propagate, and we get the general solution
$$ u(x,t) = f_+(x-t) + f_-(x+t). $$
The functions $f_\pm$ travel unchanged along the curves $x\pm t$. We call these curves <em>characteristics</em>. The characteristics extend infinitely in both directions.</p><p>We solved \eqref{1} explicitly, but more interesting wave equations cannot be solved like this. They include higher dimensions, varying coefficients, potential terms, source functions, nonlinearities, etc. For those cases, we use numerical methods.</p><p>But there&rsquo;s a problem. The wave equation is posed on a spatially unbounded domain, $x\in(-\infty, \infty)$<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. Before we can solve the equation numerically, we need to decide what to do with the unbounded domain.</p><h2 id=why-boundaries>Why boundaries?</h2><p>An argument that one finds in some textbooks and papers is that computational resources are finite, so we must truncate the solution domain artificially to some $x\in(-L, L)$ with $L$ suitably large. We then apply boundary conditions to the solution.</p><p>This artificial truncation creates two problems:</p><ul><li>boundary treatment, and</li><li>radiation extraction.</li></ul><p>The construction of boundary conditions for wave equations has been its own research direction since the 1970s, with thousands of papers written on the problem. The corresponding conditions have names such as absorbing, transparent, non-reflecting, or radiative<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. Due to the difficulty of the problem, people also constructed damping layers, which are not boundary conditions but layers of artificial dissipation that absorb the wave, such as the <a href=https://en.wikipedia.org/wiki/Perfectly_matched_layer target=_blank rel=noopener>perfectly matched layer</a>.</p><p>Even when you have a somewhat satisfactory treatment of the boundary, you still don&rsquo;t have access to the full solution. The full solution, however, is relevant when you&rsquo;re interested in the radiative fields that are defined at infinity. Whether you want to calculate radar cross-sections of airplanes or gravitational waves from black holes, you need to know the solution at infinity.</p><p>Then why don&rsquo;t we solve the full problem on the full domain? The argument of finite computational resources is clearly wrong. We can map the unbounded domain to a bounded domain. Let&rsquo;s see how that doesn&rsquo;t work.</p><h2 id=spatial-compactification>Spatial compactification</h2><p>There are many options to map the infinite domain $x\in(-\infty,\infty)$ to a finite domain in some other coordinate, $\rho$. A well-known option is the tangens function: $x = \tan \rho$ with $\rho\in[-\pi/2,\pi/2]$<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. You can also perform an algebraic compactification, $x=\rho/(1-\rho^2)$, or use the hyperbolic tangent, $x=\mathrm{arctanh}\ \rho$ with $\rho\in[-1,1]$. The basic idea is to map the infinite domain $x$ to a compact domain in $\rho$ and then solve the wave equation numerically on this finite, compact domain.</p><p>It sounds obvious and, indeed, has been tried in the 1970s<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>. The problem is that solutions oscillate out to infinity. The spatial mapping converts an unbounded domain problem to an unbounded oscillation problem, and we gain nothing.</p><p>Consider a sine-wave solution to the wave equation, $u(x,t) = \sin(x-t)$. If you compactify using the hyperbolic tangent, you get $u(\rho,t) = \sin(\mathrm{arctanh}\ \rho-t)$ which has infinite frequency at the boundaries. We can&rsquo;t even plot the function, let alone solve for it numerically.</p><p>On the level of the wave equation, the propagating wave slows down as it approaches the boundary of the compactified domain, where its propagation speed vanishes. With $\partial_x = (1-\rho^2) \partial_\rho$, we get for Eq. \eqref{1}
$$ \left[-\partial_t^2 + (1-\rho^2)^2 \partial_\rho^2 + 2 \rho (1-\rho^2) \partial_\rho \right] u(\rho,t) = 0. $$
The speed of the wave is now $c_\pm = \pm (1-\rho^2)$. Both speeds vanish at both boundaries, which implies that the outgoing characteristics get stuck. The characteristics are $x\pm t = \mathrm{arctanh} \ \rho \pm t$ plotted below.<figure id=figure-outgoing-characteristics-pile-up-near-the-boundaries-when-one-performs-only-a-spatial-compactification-radiative-fields-cannot-be-resolved-numerically-near-the-domain-boundaries><div class="d-flex justify-content-center"><div class=w-100><img alt="Outgoing characteristics pile up near the boundaries when one performs only a spatial compactification. Radiative fields cannot be resolved numerically near the domain boundaries." srcset="/post/2023/waves-on-unbounded-domains/spatial_hu3d17ac19fcda3139b318d77dd8f202c3_130448_c612598f0e6c0da9c45bb03ec2ec3f37.webp 400w,
/post/2023/waves-on-unbounded-domains/spatial_hu3d17ac19fcda3139b318d77dd8f202c3_130448_35d820a183b65b846c33fde53b0880f6.webp 760w,
/post/2023/waves-on-unbounded-domains/spatial_hu3d17ac19fcda3139b318d77dd8f202c3_130448_1200x1200_fit_q75_h2_lanczos_2.webp 1200w" src=/post/2023/waves-on-unbounded-domains/spatial_hu3d17ac19fcda3139b318d77dd8f202c3_130448_c612598f0e6c0da9c45bb03ec2ec3f37.webp width=760 height=570 loading=lazy data-zoomable></div></div><figcaption>Outgoing characteristics pile up near the boundaries when one performs only a spatial compactification. Radiative fields cannot be resolved numerically near the domain boundaries.</figcaption></figure></p><p>You can see that the outgoing characteristics pile up near the boundary (blue on the left; green on the right). This slowing down of waves near the boundary makes intuitive sense. The original wave has a constant speed and cannot reach infinity at a finite time. Therefore, the wave gets slower on the mapped domain while its wavelength becomes shorter until we cannot resolve it anymore.</p><p>In summary, waves cannot propagate to infinity when we compactify an infinite mathematical domain to a finite numerical domain. They get stuck and blueshifted. We then conclude that spatial compactification is not useful.</p><p>Unless, maybe, we&rsquo;re missing something.</p><h2 id=time-transformation>Time transformation</h2><p>The one-dimensional wave equation \eqref{1} was first written by d&rsquo;Alembert in 1747, looong before we had any inkling that &ldquo;space by itself, and time by itself, are doomed to fade away into mere shadows&rdquo;<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>. Remarkably, the wave equation enforcing balance between curvature in time and curvature in space seems to know about spacetime.</p><p>What we miss when we only consider spatial compactification is that the wave equation is a <em>spacetime</em> equation. We must transform time as well.</p><p>Consider the outgoing sine wave again. The reason for the infinite frequency problem was that the characteristics blew up near the boundaries.
Using $\mathrm{arctanh}\ \rho = \frac{1}{2} (\ln (1+\rho) - \ln(1-\rho))$, we can catch the problematic logarithms near $\rho=\pm 1$ by defining a new time coordinate $\tau$ such that<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>
$$ \tau = t + \frac{1}{2} \ln (1-\rho^2).$$
Now, the characteristics are given by
$$ x\pm t = \mp \ln(1\mp \rho) \pm \tau. $$
This behavior is the one we need: only outgoing, no incoming characteristics at both boundaries.</p><p><figure id=figure-outgoing-characteristics-leave-the-simulation-domain-through-the-boundaries-when-one-combines-spatial-compactification-with-a-suitable-time-transformation-radiative-fields-can-be-read-off-at-infinity><div class="d-flex justify-content-center"><div class=w-100><img alt="Outgoing characteristics leave the simulation domain through the boundaries when one combines spatial compactification with a suitable time transformation. Radiative fields can be read off at infinity." srcset="/post/2023/waves-on-unbounded-domains/featured_hubaa8765cb9933a4cd14303c128939dec_95458_2c422ff0a3e10921951763163f5fb92c.webp 400w,
/post/2023/waves-on-unbounded-domains/featured_hubaa8765cb9933a4cd14303c128939dec_95458_ea9f4ebb868bd7a421fba5f4a36e0fe4.webp 760w,
/post/2023/waves-on-unbounded-domains/featured_hubaa8765cb9933a4cd14303c128939dec_95458_1200x1200_fit_q75_h2_lanczos_2.webp 1200w" src=/post/2023/waves-on-unbounded-domains/featured_hubaa8765cb9933a4cd14303c128939dec_95458_2c422ff0a3e10921951763163f5fb92c.webp width=760 height=570 loading=lazy data-zoomable></div></div><figcaption>Outgoing characteristics leave the simulation domain through the boundaries when one combines spatial compactification with a suitable time transformation. Radiative fields can be read off at infinity.</figcaption></figure></p><p>For the wave equation, consider the transformation of the differential operators
$$ \partial_t = \partial_\tau, \qquad \partial_x = - \rho \ \partial_\tau\ + (1-\rho^2) \ \partial_\rho. $$
The wave equation becomes</p><p>$$ \left(-\partial_\tau^2 - 2 \rho\ \partial_\tau \partial_\rho + (1-\rho^2) \partial_\rho^2 - \partial_\tau - 2 \rho \ \partial_\rho \right) u(\rho,\tau) = 0. \tag{2}\label{2} $$
It looks a bit more complicated than \eqref{1}, but now you can solve the equation numerically on the <em>entire</em> domain! Below is the dynamical solution for Gaussian initial data.<figure id=figure-solution-of-the-wave-equation-with-hyperboloidal-compactification-it-looks-just-like-the-solution-to-the-wave-equation-in-standard-coordinates-but-the-boundaries-correspond-to-infinity><div class="d-flex justify-content-center"><div class=w-100><img alt="Solution of the wave equation with hyperboloidal compactification. It looks just like the solution to the wave equation in standard coordinates, but the boundaries correspond to infinity. " src=/post/2023/waves-on-unbounded-domains/tangens.gif loading=lazy data-zoomable></div></div><figcaption>Solution of the wave equation with hyperboloidal compactification. It looks just like the solution to the wave equation in standard coordinates, but the boundaries correspond to infinity.</figcaption></figure></p><p>The waves leave the spacetime smoothly through the outer boundaries, which correspond to the two infinities at either side. The solution at these boundaries is the radiative field. No extrapolation is necessary! Combining the spatial compactification with a suitable time transformation solved both the boundary and the radiation problems.</p><p>The time transformation that we used is not unique. There are many other options. These time functions are called <em>hyperboloidal</em>. Below is the generalization.</p><h2 id=hyperboloidal-compactification>Hyperboloidal compactification</h2><p>Hyperboloidal compactification consists of a spatial compactification
$$ \rho = g(x), $$
together with a suitable time transformation
$$ \tau = t + h(x), $$
To see what <em>suitable</em> means here, let&rsquo;s define
$$ H:= \frac{dh}{dx}, \qquad G:= \frac{dg}{dx}. $$
As a compactification, $G$ vanishes at the boundaries. The wave equation becomes after a division by $G$
$$ \left(-\frac{1-H^2}{G} \partial_\tau^2 + 2 H \partial_\tau \partial_\rho + G \partial_\rho^2 + H&rsquo; \partial_\tau + G&rsquo;\partial_\rho \right) u(\rho,\tau) = 0. $$
For this equation to be regular, we require $1-H^2 \sim G$ at the boundaries, which means $|H|\sim 1$ at the leading order. We also want $|H|&lt;1$ away from the boundaries to keep the principal part intact<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>. This is the hyperboloidal compactification.</p><p>To solve the hyperboloidal wave equation \eqref{2}, it&rsquo;s best to write it in symmetric hyperbolic form. We define the auxiliary variables
$$ \psi := \partial_\rho u, \qquad \pi := \frac{1-H^2}{G} \partial_\tau u - H \partial_\rho u. $$
The full system reads
$$\partial_\tau \pi = \partial_\rho \left[\frac{G}{1-H^2} ( \psi + H \pi ) \right], $$
$$\partial_\tau \psi = \partial_\rho \left[\frac{G}{1-H^2} (H\psi + \pi )\right],$$
$$ \partial_\tau u = \frac{G}{1-H^2} (H \psi + \pi).$$</p><p>The system is symmetric. Hyperbolicity follows from the properties of $H$ and $G$. For the case that we discussed above, we have
$$ \rho = \tanh x, \qquad \tau = t - \ln(\cosh x) = t + \frac{1}{2} \ln (1-\rho^2). $$
The functions $G$ and $H$ are
$$ G = 1-\rho^2, \quad H = -\rho \quad \Rightarrow \quad \frac{G}{1-H^2} = 1. $$
The equation becomes very simple
$$\partial_\tau \pi = \partial_\rho \left( \psi - \rho \ \pi \right),$$
$$\partial_\tau \psi = \partial_\rho \left(- \rho\ \psi + \pi \right), \tag{3}\label{3}$$
$$\partial_\tau u = (-\rho\ \psi + \pi).$$</p><p>Next, we solve this equation numerically.</p><h2 id=numerical-implementation>Numerical implementation</h2><p>I picked a simple method that&rsquo;s relatively accurate: 4th-order finite differences in space and 4th-order Runge-Kutta integration in time. The finite difference operators are one-sided at the boundaries.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>diff</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>h</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>kernel</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>8</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>du</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>convolve</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>kernel</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s2>&#34;same&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># One-sided stencils at the boundaries</span>
</span></span><span class=line><span class=cl>    <span class=n>du</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mf>25.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mf>48.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mf>36.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mf>16.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>-</span> <span class=mf>3.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>du</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mf>3.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mf>10.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>18.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>-</span> <span class=mf>6.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=n>u</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>du</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mf>25.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mf>48.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=mf>36.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>]</span> <span class=o>-</span> <span class=mf>16.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=mf>3.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>du</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mf>3.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mf>10.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=o>-</span> <span class=mf>18.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=mf>6.0</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>-</span> <span class=n>u</span><span class=p>[</span><span class=o>-</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>du</span> <span class=o>/</span> <span class=p>(</span><span class=mf>12.0</span> <span class=o>*</span> <span class=n>h</span><span class=p>)</span>
</span></span></code></pre></div><p>The Runge-Kutta integrator is standard</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>rk4</span><span class=p>(</span><span class=n>cur</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>nex</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>cur</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>k1</span> <span class=o>=</span> <span class=n>dt</span> <span class=o>*</span> <span class=n>rhs</span><span class=p>(</span><span class=n>nex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>k2</span> <span class=o>=</span> <span class=n>dt</span> <span class=o>*</span> <span class=n>rhs</span><span class=p>(</span><span class=n>nex</span> <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>k1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>k3</span> <span class=o>=</span> <span class=n>dt</span> <span class=o>*</span> <span class=n>rhs</span><span class=p>(</span><span class=n>nex</span> <span class=o>+</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>k2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>k4</span> <span class=o>=</span> <span class=n>dt</span> <span class=o>*</span> <span class=n>rhs</span><span class=p>(</span><span class=n>nex</span> <span class=o>+</span> <span class=n>k3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>nex</span> <span class=o>+=</span> <span class=p>(</span><span class=n>k1</span> <span class=o>+</span> <span class=mf>2.0</span> <span class=o>*</span> <span class=p>(</span><span class=n>k2</span> <span class=o>+</span> <span class=n>k3</span><span class=p>)</span> <span class=o>+</span> <span class=n>k4</span><span class=p>)</span> <span class=o>/</span> <span class=mf>6.0</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>nex</span>
</span></span></code></pre></div><p>Below is the right-hand side calculation. I combine the variables $(u, \psi, \pi)$ into a single array <code>u</code>. The function <code>rhs</code> takes the array <code>u</code> and returns the right-hand side of the system for the symmetric hyperbolic formulation of the hyperboloidal wave equation \eqref{3}.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>rhs</span><span class=p>(</span><span class=n>u</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>rhs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>hg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>rhs</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=p>:]</span> <span class=o>-</span> <span class=n>x</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=n>rhs</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>diff</span><span class=p>(</span><span class=n>rhs</span><span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=p>:],</span> <span class=n>hg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>rhs</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>diff</span><span class=p>(</span><span class=n>u</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=p>:]</span> <span class=o>-</span> <span class=n>x</span> <span class=o>*</span> <span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=p>:],</span> <span class=n>hg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>rhs</span>
</span></span></code></pre></div><p>Then we integrate the equation iteratively in time.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve_wave_eq</span><span class=p>(</span><span class=n>initial</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(((</span><span class=n>nsteps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,)</span> <span class=o>+</span> <span class=n>initial</span><span class=o>.</span><span class=n>shape</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=p>:,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>initial</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>nsteps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=p>:,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>rk4</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=p>:,</span> <span class=p>:])</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Finished evolution at t = &#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>dt</span> <span class=o>*</span> <span class=n>nsteps</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span>
</span></span></code></pre></div><p>That&rsquo;s it. The rest is just setting up initial data and parameters. To play around and try different methods, use the Colab notebook as a starting point.</p><a target=_blank href="https://colab.research.google.com/drive/1w-cmd1UEWqQ6Bu1rHnfASp1ue7eCPLl4?usp=sharing"><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a><h2 id=epilogue>Epilogue</h2><p>We discussed the simplest example of a wave equation. You may wonder about the wider applicability of this method. It has been applied in higher dimensions with varying coefficients, potential terms, source functions, and nonlinearities. I might write about black-hole perturbations in a future post.</p><p>While this technique is relatively well-known in relativity, it&rsquo;s not used at all in other fields where wave propagation is relevant. It would be fascinating to see this relativistic method applied to a non-relativistic problem, such as the propagation of acoustic waves or the computation of radar cross-sections.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Even when the physical domain is not unbounded, infinity may be a better model than a large distance because the relevant wavelengths are small compared to the domain size. I argued this point in another blog post: <a href=../empirical-infinity>How far is infinity?</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>There is a reason for these different names. The main goal of the boundary condition is that the solution doesn&rsquo;t see the boundary. In higher dimensions, boundary conditions typically lead to artificial reflections for waves that hit the boundary at an incidence angle. Therefore, the data should be absorbing or non-reflective. But that&rsquo;s not sufficient for equations with a potential term or nonlinearities because there is scattering all the way to infinity and simply absorbing the wave is not faithful to the actual solution. Note that we also distinguish between boundary <em>conditions</em> that should lead to a well-posed initial-boundary problem and boundary <em>data</em> that should lead to the transparency of the artificial boundary. After decades of research and thousands of papers, there is no <em>local and exact</em> solution to the unbounded domain problem other than compactification.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Strictly speaking, the mapping is only valid for $\rho\in(-\pi/2,\pi/2)$, which is an open interval and therefore not compact. Compactification extends space by adding the limit points to the domain. This is a subtle process that assumes a certain behavior of mathematical objects in space, but for this post, think of it as adding the points at infinity $\{-1\}$ and
$\{1\}$ to the open interval $(-1,1)$ to make it compact. The reason we can do this has to do with the asymptotic properties of wave equations.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Grosch and Orszag studied such mappings in 1977 in their paper <a href=https://www.sciencedirect.com/science/article/abs/pii/0021999177901024 target=_blank rel=noopener>&ldquo;Numerical solution of problems in unbounded regions: Coordinate transforms&rdquo;</a>. They concluded that &ldquo;solutions that oscillate out to infinity are not so amenable to these techniques.&rdquo;&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>This is one of my favorite scientific quotes, and it goes like this: &ldquo;Henceforth, space by itself, and time by itself, are doomed to fade away into mere shadows, and only a kind of union of the two will preserve an independent reality.&rdquo; <a href=https://en.wikipedia.org/wiki/Hermann_Minkowski target=_blank rel=noopener>Hermann Minkowski</a> made this statement while showing that special relativity could be understood geometrically as a theory of four-dimensional spacetime in an address to German Natural Scientists and Physicians in 1908, a few months before his death at the age of 44.&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>The time function can also be written in terms of $x$ as $\tau = t - \ln (\cosh x)$.&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p>Setting $H=\pm 1$ everywhere corresponds to <a href=https://link.springer.com/article/10.12942/lrr-2012-2 target=_blank rel=noopener>characteristic evolution</a>. This method is used in solving Einstein equations. I won&rsquo;t go into further detail here because the characteristic transformation changes the nature of the principal part requiring specially designed numerical methods.&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=article-tags><a class="badge badge-light" href=/tag/hyperboloidal/>Hyperboloidal</a>
<a class="badge badge-light" href=/tag/nsf-2309084/>NSF-2309084</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fanilzen.github.io%2Fpost%2F2023%2Fwaves-on-unbounded-domains%2F&amp;text=How+to+solve+wave+equations+on+unbounded+domains" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fanilzen.github.io%2Fpost%2F2023%2Fwaves-on-unbounded-domains%2F&amp;t=How+to+solve+wave+equations+on+unbounded+domains" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=How%20to%20solve%20wave%20equations%20on%20unbounded%20domains&amp;body=https%3A%2F%2Fanilzen.github.io%2Fpost%2F2023%2Fwaves-on-unbounded-domains%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fanilzen.github.io%2Fpost%2F2023%2Fwaves-on-unbounded-domains%2F&amp;title=How+to+solve+wave+equations+on+unbounded+domains" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=How+to+solve+wave+equations+on+unbounded+domains%20https%3A%2F%2Fanilzen.github.io%2Fpost%2F2023%2Fwaves-on-unbounded-domains%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fanilzen.github.io%2Fpost%2F2023%2Fwaves-on-unbounded-domains%2F&amp;title=How+to+solve+wave+equations+on+unbounded+domains" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://anilzen.github.io/><img class="avatar mr-3 avatar-circle" src=/authors/anil/avatar_hubdbe8f760004904350d82355aac46df7_167987_270x270_fill_q75_lanczos_center.jpg alt="Anıl Zenginoğlu"></a><div class=media-body><h5 class=card-title><a href=https://anilzen.github.io/>Anıl Zenginoğlu</a></h5><h6 class=card-subtitle>Assistant Research Scientist</h6><p class=card-text>Research scientist and administrator exploring spacetime infinity.</p><ul class=network-icon aria-hidden=true><li><a href=mailto:anil@umd.edu><i class="fas fa-envelope"></i></a></li><li><a href=https://www.linkedin.com/in/anilzen/ target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a href="https://scholar.google.com/citations?user=M8NnUIQAAAAJ&amp;hl=en" target=_blank rel=noopener><i class="ai ai-google-scholar"></i></a></li><li><a href=https://github.com/anilzen target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://orcid.org/0000-0001-7896-6268 target=_blank rel=noopener><i class="fab fa-orcid"></i></a></li><li><a href=https://twitter.com/AnilZenginoglu target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li><li><a href=https://mathstodon.xyz/@anilzen target=_blank rel=noopener><i class="fab fa-mastodon"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2025 Anıl Zenginoğlu. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target=_blank rel=noopener>Hugo Blox Builder</a> — the free, <a href=https://github.com/HugoBlox/hugo-blox-builder target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.391d344a129df56f7ad674c2c2ed04e8.js></script><script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script><script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script><script src=/en/js/wowchemy.min.7f5ebaff62ae468cff8bb3dd1337bb9b.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy
</a><a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.9c0e895144aef5a693008b5c5d450147.js type=module></script></body></html>